[
	{
		"name": "cx_translations",
		"columns": [
			{
				"name": "translation_id",
				"comment": "translation id. Autogenerated.",
				"type": "integer",
				"options": { "autoincrement": true, "notnull": true }
			},
			{
				"name": "translation_source_title",
				"comment": "Source title of the translation",
				"type": "binary",
				"options": { "notnull": true, "length": 512 }
			},
			{
				"name": "translation_target_title",
				"comment": "Target title of the translation",
				"type": "binary",
				"options": { "notnull": true, "length": 512 }
			},
			{
				"name": "translation_source_language",
				"comment": "Source language. language code",
				"type": "binary",
				"options": { "notnull": true, "length": 36 }
			},
			{
				"name": "translation_target_language",
				"comment": "Target language. language code",
				"type": "binary",
				"options": { "notnull": true, "length": 36 }
			},
			{
				"name": "translation_source_revision_id",
				"comment": "Revision id of source article",
				"type": "integer",
				"options": { "notnull": false, "unsigned": true }
			},
			{
				"name": "translation_target_revision_id",
				"comment": "Revision id of published translation",
				"type": "integer",
				"options": { "notnull": false, "unsigned": true }
			},
			{
				"name": "translation_source_url",
				"comment": "source of the page as full canonical url -- https://www.mediawiki.org/wiki/Help:CxIsPage",
				"type": "blob",
				"options": { "notnull": true, "length": 65535 }
			},
			{
				"name": "translation_target_url",
				"comment": "link to the draft/published target",
				"type": "blob",
				"options": { "notnull": false, "length": 65535 }
			},
			{
				"name": "translation_status",
				"comment": "Status of translation - Draft or published status. There is no final status. A published translation can be draft again to update again",
				"type": "mwenum",
				"options": {
					"notnull": false,
					"CustomSchemaOptions": {
						"enum_values": [ "draft", "published", "deleted" ]
					}
				}
			},
			{
				"name": "translation_start_timestamp",
				"comment": "Start date of this translation",
				"type": "mwtimestamp",
				"options": { "notnull": true }
			},
			{
				"name": "translation_last_updated_timestamp",
				"comment": "Last updated date of this translation",
				"type": "mwtimestamp",
				"options": { "notnull": true }
			},
			{
				"name": "translation_progress",
				"comment": "Progress of the translation - json dump",
				"type": "blob",
				"options": { "notnull": true, "length": 255 }
			},
			{
				"name": "translation_started_by",
				"comment": "Who started this translation? User id",
				"type": "integer",
				"options": { "notnull": false }
			},
			{
				"name": "translation_last_update_by",
				"comment": "Who did the last translation? It need not be the translator who started.",
				"type": "integer",
				"options": { "notnull": false }
			},
			{
				"name": "translation_cx_version",
				"comment": "Field to indicate which version of CX",
				"type": "mwtinyint",
				"options": { "notnull": false, "unsigned": true, "default": 1 }
			}
		],
		"indexes": [
			{
				"name": "cx_translation_ref",
				"columns": [ "translation_source_title", "translation_source_language", "translation_target_language", "translation_started_by" ],
				"unique": true
			},
			{
				"name": "cx_translation_languages",
				"columns": [ "translation_source_language", "translation_target_language", "translation_status" ],
				"unique": false
			},
			{
				"name": "cx_translation_target_title",
				"columns": [ "translation_target_title" ],
				"unique": false
			}
		],
		"pk": [ "translation_id" ]
	},
	{
		"name": "cx_translators",
		"columns": [
			{
				"name": "translator_user_id",
				"comment": "Translators id - global user id",
				"type": "integer",
				"options": { "notnull": true }
			},
			{
				"name": "translator_translation_id",
				"comment": "Translation id - foreign key to translations.translation_id",
				"type": "integer",
				"options": { "notnull": true }
			}
		],
		"indexes": [
			{
				"name": "cx_translators_translation_id",
				"columns": [ "translator_translation_id" ],
				"unique": false
			}
		],
		"pk": [ "translator_user_id", "translator_translation_id" ]
	},
	{
		"name": "cx_lists",
		"comment": "Content translation suggestion related tables",
		"columns": [
			{
				"name": "cxl_id",
				"comment": "List id",
				"type": "integer",
				"options": { "autoincrement": true, "notnull": true }
			},
			{
				"name": "cxl_type",
				"comment": "Type of the list such as features, popular, etc.",
				"type": "integer",
				"options": { "notnull": false, "default": 0 }
			},
			{
				"name": "cxl_owner",
				"comment": "Owner of the list",
				"type": "integer",
				"options": { "notnull": true }
			},
			{
				"name": "cxl_public",
				"type": "mwtinyint",
				"options": { "notnull": true, "length": 1 }
			},
			{
				"name": "cxl_start_time",
				"comment": "Optional validity period for the list",
				"type": "mwtimestamp",
				"options": { "notnull": false }
			},
			{
				"name": "cxl_end_time",
				"comment": "Optional validity period for the list",
				"type": "mwtimestamp",
				"options": { "notnull": false }
			},
			{
				"name": "cxl_name",
				"comment": "Name for the suggestion list",
				"type": "binary",
				"options": { "notnull": true, "length": 512 }
			},
			{
				"name": "cxl_info",
				"comment": "Url to page with additional info about the list",
				"type": "blob",
				"options": { "notnull": false, "length": 16777215 }
			}
		],
		"indexes": [
			{
				"name": "cx_lists_relevant",
				"columns": [ "cxl_type", "cxl_public", "cxl_start_time", "cxl_end_time" ],
				"unique": true
			}
		],
		"pk": [ "cxl_id" ]
	},
	{
		"name": "cx_suggestions",
		"comment": "",
		"columns": [
			{
				"name": "cxs_list_id",
				"comment": "Foreign key to cxl_id",
				"type": "integer",
				"options": { "notnull": true }
			},
			{
				"name": "cxs_source_language",
				"comment": "Source language code",
				"type": "binary",
				"options": { "notnull": true, "length": 36 }
			},
			{
				"name": "cxs_target_language",
				"comment": "Target language code",
				"type": "binary",
				"options": { "notnull": false, "length": 36 }
			},
			{
				"name": "cxs_title",
				"comment": "Title of the suggestion",
				"type": "binary",
				"options": { "notnull": true, "length": 512 }
			}
		],
		"indexes": [
			{
				"name": "cx_suggestions_by_lang",
				"columns": [ "cxs_list_id", "cxs_source_language", "cxs_target_language" ],
				"unique": false
			}
		],
		"pk": []
	},
	{
		"name": "cx_corpora",
		"comment": "Table to store parallel corpora data. Special cxc_section_id of CX_CATEGORY_METADATA is used to store pairs of source and target categories",
		"columns": [
			{
				"name": "cxc_id",
				"type": "integer",
				"options": { "autoincrement": true, "notnull": true, "unsigned": true }
			},
			{
				"name": "cxc_translation_id",
				"comment": "Translation to join with cx_translations",
				"type": "integer",
				"options": { "notnull": true }
			},
			{
				"name": "cxc_section_id",
				"comment": "Section id, generated by Parsoid",
				"type": "binary",
				"options": { "notnull": true, "length": 30 }
			},
			{
				"name": "cxc_origin",
				"comment": "Origin of the content. Can be source, Apertium, Yandex etc, and user",
				"type": "binary",
				"options": { "notnull": true, "length": 30 }
			},
			{
				"name": "cxc_sequence_id",
				"comment": "Optional sequence id",
				"type": "integer",
				"options": { "notnull": false }
			},
			{
				"name": "cxc_timestamp",
				"comment": "Optional timestamp",
				"type": "mwtimestamp",
				"options": { "notnull": false }
			},
			{
				"name": "cxc_content",
				"comment": "Content",
				"type": "blob",
				"options": { "notnull": false, "length": 16777215 }
			}
		],
		"indexes": [
			{
				"name": "cx_corpora_unique",
				"columns": [ "cxc_translation_id", "cxc_origin", "cxc_section_id", "cxc_timestamp" ],
				"unique": true
			}
		],
		"pk": [ "cxc_id" ]
	},
	{
		"name": "cx_notification_log",
		"columns": [
			{
				"name": "cxn_id",
				"comment": "Notification log id - autogenerated",
				"type": "integer",
				"options": { "autoincrement": true, "notnull": true }
			},
			{
				"name": "cxn_date",
				"comment": "Date when notification script was run",
				"type": "mwtimestamp",
				"options": { "notnull": true }
			},
			{
				"name": "cxn_newest",
				"comment": "Newest draft which was updated with this script run",
				"type": "mwtimestamp",
				"options": { "notnull": true }
			},
			{
				"name": "cxn_wiki_id",
				"comment": "Wiki ID of draft notification sent by the script",
				"type": "binary",
				"options": { "notnull": false, "length": 64 }
			}
		],
		"indexes": [
			{
				"name": "cxn_wiki_id_newest",
				"comment": "Support query: SELECT MAX(cxn_newest) WHERE cxn_wiki_id = 'X'",
				"columns": [ "cxn_wiki_id", "cxn_newest" ],
				"unique": false
			}
		],
		"pk": [ "cxn_id" ]
	},
	{
		"name": "cx_significant_edits",
		"comment": "Stores recent significant edits by a user in any wiki. Only the 10 latest edits by each user are stored. This table is used to identify potential section suggestions for the 'recent-edit' entrypoint",
		"columns": [
			{
				"name": "cxse_id",
				"comment": "edit id. Autogenerated",
				"type": "integer",
				"options": { "notnull": true, "unsigned": true, "autoincrement": true }
			},
			{
				"name": "cxse_global_user_id",
				"comment": "Global user id of the user that did the edit",
				"type": "integer",
				"options": { "notnull": true, "unsigned": true }
			},
			{
				"name": "cxse_page_wikidata_id",
				"comment": "Wikidata id (qid) of the page that was edited without the 'Q' prefix",
				"type": "integer",
				"options": { "notnull": true, "unsigned": true }
			},
			{
				"name": "cxse_language",
				"comment": "Language of the page that was edited. Used as source language to fetch section suggestions from cxserver, when user visits a page that they have edited, in another language.",
				"type": "binary",
				"options": { "notnull": true, "length": 36 }
			},
			{
				"name": "cxse_wiki_family",
				"comment": "Wiki family of the wiki in which the edit happened. Currently unused, but added for future expansion of Content Translation to non-Wikipedia wikis",
				"type": "integer",
				"options": { "notnull": true, "unsigned": true }
			},
			{
				"name": "cxse_page_title",
				"comment": "Title of the page that was edited. Used as source title to fetch section suggestions from cxserver, when user visits a page that they have edited, in another language.",
				"type": "binary",
				"options": { "notnull": true, "length": 255 }
			},
			{
				"name": "cxse_section_titles",
				"comment": "Titles of the sections that were edited. Stores a JSON string representing an array of strings",
				"type": "blob",
				"options": { "notnull": true, "length": 16777215 }
			},
			{
				"name": "cxse_timestamp",
				"comment": "Timestamp of this edit",
				"type": "mwtimestamp",
				"options": { "notnull": true }
			}
		],
		"indexes": [
			{
				"name": "cx_significant_edits_page",
				"comment": "Query edits that were made by a specific user, for a page with a specific Wikidata ID, in a specific language and wiki-family",
				"columns": [
					"cxse_global_user_id",
					"cxse_page_wikidata_id",
					"cxse_language",
					"cxse_wiki_family"
				],
				"unique": true
			}
		],
		"pk": [ "cxse_id" ]
	},
	{
		"name": "cx_section_translations",
		"columns": [
			{
				"name": "cxsx_id",
				"comment": "Section translation id. Autogenerated",
				"type": "integer",
				"options": { "notnull": true, "unsigned": true, "autoincrement": true }
			},
			{
				"name": "cxsx_translation_id",
				"comment": "Translation id. translation_id from cx_translations table",
				"type": "integer",
				"options": { "notnull": true, "unsigned": true }
			},
			{
				"name": "cxsx_section_id",
				"comment": "Section id. Based on source revision id and cx id of the translated page section",
				"type": "binary",
				"options": { "notnull": true, "length": 30 }
			},
			{
				"name": "cxsx_source_section_title",
				"comment": "Source section title",
				"type": "binary",
				"options": { "notnull": true, "length": 512 }
			},
			{
				"name": "cxsx_target_section_title",
				"comment": "Target section title",
				"type": "binary",
				"options": { "notnull": true, "length": 512 }
			},
			{
				"name": "cxsx_translation_status",
				"comment": "Status of the section translation. Possible values 0 (for 'draft'), 1 (for 'published'), 2 (for 'deleted')",
				"type": "mwtinyint",
				"options": { "notnull": false, "length": 1 }
			},
			{
				"name": "cxsx_translation_progress",
				"comment": "Progress of the section translation - json dump",
				"type": "blob",
				"options": { "notnull": true, "length": 255 }
			},
			{
				"name": "cxsx_translation_start_timestamp",
				"comment": "Start date of this translation",
				"type": "mwtimestamp",
				"options": { "notnull": true }
			},
			{
				"name": "cxsx_translation_last_updated_timestamp",
				"comment": "Last updated date of this translation",
				"type": "mwtimestamp",
				"options": { "notnull": true }
			}
		],
		"indexes": [
			{
				"name": "cx_sx_sections",
				"comment": "Translation to sections relation",
				"columns": [
					"cxsx_translation_id",
					"cxsx_section_id"
				],
				"unique": true
			}
		],
		"pk": [ "cxsx_id" ]
	}
]
